let App = getApp(); Page({ data: { recentSearch: [], searchValue: '', }, onLoad: function (options) { }, onShow: function () { this.getRecentSearch() }, getRecentSearch: function () { let recentSearch = wx.getStorageSync('recentSearch'); this.setData({ recentSearch }) }, getSearchContent: function (e) { this.data.searchValue = e.detail.value }, search: function () { if (this.data.searchValue) { let recentSearch = wx.getStorageSync('recentSearch') || []; let index = recentSearch.indexOf(this.data.searchValue); index > -1 && recentSearch.splice(index, 1); recentSearch.unshift(this.data.searchValue); wx.setStorageSync('recentSearch', recentSearch); wx.navigateTo({ url: '../category/list?search=' + this.data.searchValue, }) } }, clearSearch: function () { wx.removeStorageSync('recentSearch'); this.getRecentSearch() }, goSearch: function (e) { wx.navigateTo({ url: '../category/list?search=' + e.target.dataset.text, }) }, })