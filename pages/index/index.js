const App = getApp(); Page({ data: { options: {}, items: {}, scrollTop: 0, }, onLoad: function (options) { this.setData({ options }); this.getPageData() }, getPageData: function (callback) { let _this = this; App._get('page/index', { page_id: _this.data.options.page_id || 0 }, function (result) { _this.setPageBar(result.data.page); _this.setData(result.data); typeof callback === 'function' && callback() }) }, setPageBar: function (page) { wx.setNavigationBarTitle({ title: page.params.title }); wx.setNavigationBarColor({ frontColor: page.style.titleTextColor === 'white' ? '#ffffff' : '#000000', backgroundColor: page.style.titleBackgroundColor }) }, onShareAppMessage() { let _this = this; return { title: _this.data.page.params.share_title, path: "/pages/index/index?" + App.getShareUrlParams() } }, onPullDownRefresh: function () { this.getPageData(function () { wx.stopPullDownRefresh() }) } });