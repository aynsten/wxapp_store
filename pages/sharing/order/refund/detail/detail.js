const App = getApp(); Page({ data: { order_refund_id: null, detail: {}, expressIndex: -1, }, disable: false, onLoad: function (options) { this.data.order_refund_id = options.order_refund_id; this.getRefundDetail() }, getRefundDetail: function () { let _this = this; App._get('sharing.refund/detail', { order_refund_id: this.data.order_refund_id }, function (result) { _this.setData(result.data) }) }, onGoodsDetail: function (e) { App.saveFormId(e.detail.formId); wx.navigateTo({ url: '../../../goods/index?goods_id=' + e.detail.target.dataset.id }) }, previewImages: function (e) { let imageUrls = []; this.data.detail.image.forEach(function (item) { imageUrls.push(item.file_path) }); wx.previewImage({ current: imageUrls[e.target.dataset.index], urls: imageUrls }) }, onExpressChange: function (e) { this.setData({ expressIndex: e.detail.value }) }, onSubmit: function (e) { let _this = this, values = e.detail.value; App.saveFormId(e.detail.formId); if (_this.disable === true) { return false } _this.disable = true; wx.showLoading({ title: '正在处理...', mask: true }); values['order_refund_id'] = _this.data.order_refund_id; App._post_form('sharing.refund/delivery', values, function (result) { App.showSuccess(result.msg, function () { _this.getRefundDetail() }) }, false, function () { wx.hideLoading(); _this.disable = false }) }, })