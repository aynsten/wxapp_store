let App = getApp(); Page({ data: { list: [], default_id: null, }, onLoad: function (options) { this.data.options = options }, onShow: function () { this.getAddressList() }, getAddressList: function () { let _this = this; App._get('address/lists', {}, function (result) { _this.setData(result.data) }) }, createAddress: function () { wx.navigateTo({ url: './create' }) }, editAddress: function (e) { wx.navigateTo({ url: "./detail?address_id=" + e.currentTarget.dataset.id }) }, removeAddress: function (e) { let _this = this, address_id = e.currentTarget.dataset.id; wx.showModal({ title: "提示", content: "您确定要移除当前收货地址吗?", success: function (o) { o.confirm && App._post_form('address/delete', { address_id }, function (result) { _this.getAddressList() }) } }) }, setDefault: function (e) { let _this = this, address_id = e.detail.value; _this.setData({ default_id: parseInt(address_id) }); App._post_form('address/setDefault', { address_id }, function (result) { _this.data.options.from === 'flow' && wx.navigateBack() }); return false }, });