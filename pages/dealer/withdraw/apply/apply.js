const App = getApp(); Page({ data: { isData: false, words: {}, payment: 20, }, onLoad: function (options) { }, onShow: function () { this.getDealerWithdraw() }, getDealerWithdraw: function () { let _this = this; App._get('user.dealer/withdraw', {}, function (result) { let data = result.data; data.isData = true; wx.setNavigationBarTitle({ title: data.words.withdraw_apply.title.value }); data['payment'] = data.settlement.pay_type[0]; _this.setData(data) }) }, formSubmit: function (e) { let _this = this, values = e.detail.value, words = _this.data.words.withdraw_apply.words; App.saveFormId(e.detail.formId); if (_this.data.dealer.money <= 0) { App.showError('当前没有' + words.capital.value); return false } if (!values.money || values.money.length < 1) { App.showError('请填写' + words.money.value); return false } _this.setData({ disabled: true }); values['pay_type'] = _this.data.payment; App._post_form('user.dealer.withdraw/submit', { data: JSON.stringify(values) }, function (result) { App.showError(result.msg, function () { wx.navigateTo({ url: '../list/list', }) }) }, null, function () { _this.setData({ disabled: false }) }) }, toggleChecked: function (e) { this.setData({ payment: e.currentTarget.dataset.payment }) }, })