const App = getApp(); import RechargeTypeEnum from '../../../utils/enum/recharge/order/RechargeType.js'; Page({ data: { userInfo: {}, setting: {}, selectedPlanId: 0, inputValue: '', disabled: false, }, onLoad(options) { }, onShow() { let _this = this; _this.getRechargeIndex() }, getRechargeIndex() { let _this = this; App._get('recharge/index', {}, function (result) { _this.setData(result.data) }) }, onSelectPlan(e) { let _this = this; _this.setData({ selectedPlanId: e.currentTarget.dataset.id, inputValue: '' }) }, bindMoneyInput(e) { let _this = this; _this.setData({ inputValue: e.detail.value, selectedPlanId: 0 }) }, onSubmit(e) { let _this = this; App.saveFormId(e.detail.formId); _this.setData({ disabled: true }); App._post_form('recharge/submit', { planId: _this.data.selectedPlanId, customMoney: _this.data.inputValue }, (result) => { App.wxPayment({ payment: result.data.payment, success() { App.showSuccess(result.msg.success, () => { wx.navigateBack() }) }, fail(res) { App.showError(result.msg.error) }, complete(res) { } }) }, false, () => { _this.setData({ disabled: false }) }) }, })