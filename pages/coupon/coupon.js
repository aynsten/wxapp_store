const App = getApp(); Page({ data: { list: [], notcont: false }, onLoad: function (options) { this.data.options = options }, onShow: function () { this.getCouponList() }, getCouponList: function () { let _this = this; App._get('coupon/lists', {}, function (result) { _this.setData({ list: result.data.list, notcont: !result.data.list.length }) }) }, receive: function (e) { let _this = this, couponId = e.currentTarget.dataset.couponId; App._post_form('user.coupon/receive', { coupon_id: couponId }, function (result) { App.showSuccess(result.msg); _this.getCouponList() }) }, });